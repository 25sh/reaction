<template name="coreOrderShippingInvoice">

  <form name="capture">
    <div>
      {{> React component=LineItemsContainer items=items invoice=invoice}}
    </div>

    <div>
      {{> React component=InvoiceContainer
                invoice=invoice
                orderId=orderId
                refunds=refunds
                isFetching=isFetching
                collection="Orders"}}
    </div>

    <div class="flex">

      {{#if paymentPendingApproval}}
        <button class="btn btn-info btn-block" type="submit" data-event-action="approveInvoice" data-i18n="order.approveInvoice">Approve</button>
      {{/if}}

      {{#if paymentApproved}}
          <a
            class="btn btn-link"
            href="{{pathFor "dashboard/pdf/orders" id=orderId }}?shipment={{fulfillment._id}}"
            target="_blank"
            data-i18n="app.print">
            Print
          </a>
          <button class="btn btn-success flex-item-fill" type="button" data-event-action="capturePayment" {{capturedDisabled}}>
            <span id="btn-capture-payment" data-i18n="order.capturePayment">Capture Payment</span>
            <i class="fa fa-spinner fa-spin {{#unless isCapturing}}hidden{{/unless}}" id="btn-processing"></i>
          </button>
      {{/if}}
    </div>
  </form>

  {{#if paymentCaptured}}
    <form name="refund">
      <div class="flex">
        <div class="form-group order-summary-form-group">
          <div class="invoice-details">
            {{> React refundInputProps}}
          </div>
        </div>
        <button
          class="btn btn-success flex-item-fill refund-button"
          type="submit"
          data-event-action="applyRefund"
          {{refundSubmitDisabled}}
        >
          <span id="btn-refund-payment" data-i18n="order.applyRefund">Apply Refund</span>
          <i class="fa fa-spinner fa-spin {{#unless isRefunding}}hidden{{/unless}}"></i>
        </button>
      </div>

      <div>
        {{> React component=TotalActionsContainer
                  invoice=invoice
                  canMakeAdjustments=canMakeAdjustments
                  paymentCaptured=paymentCaptured
                  adjustedTotal=adjustedTotal}}
      </div>

      <div class="reason">
        {{> inlineAlerts placement="coreOrderRefund"}}
      </div>

      <br> <br>

      <button
        class="btn btn-default btn-block"
      >
        <a
        href="{{pathFor "dashboard/pdf/orders" id=orderId }}?shipment={{fulfillment._id}}"
        target="_blank"
        data-i18n="app.printInvoice">
          Print Invoice
        </a>
      </button>
    </form>
  {{else}}

  {{/if}}

</template>
